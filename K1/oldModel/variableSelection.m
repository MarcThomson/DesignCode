Aeq = [0	0	1	1	-1	0	0	0	-1	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	-0.084	-0.061	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	-0.041	-0.034	0	0	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0	0	1	-1	0	0	0	0	-0.08	-0.039	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0
3	0	0	0	1	0	0	0	0	0	0	0	0	2.5	1.5	-8.68	-9.2	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	1	0	0
0	0	0	2	1	0	1	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0
0	0	0	0	0	0	0	0	0	0	0	0	2	0	0	-0.026	-0.024	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-2	0	0
0	0	0	0	1	0	0	0	0	0	0	0	0	0	-1	0.004	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.5
-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-0.452	0	0	0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	-0.087	-0.045	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0	0	0
0	0	-1	0	0	0	0	1	1	0	1	0	0	0	0	0.008	-0.048	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	-1	0
0	0	0	0	0	0	0	0	0	0	0	2	0	0	0	-0.056	-0.072	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0
0	1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	1	-1	-1	0	0	0	0	0	0	0	0	0.445	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
2	-1	0	0	0	0	0	0	0	0	0	-1	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1
0	0	0	2	1	1	0	0	-1	0	0	0	0	-1	0	0.639	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0.5
0	0	0	0	0	0	0	1	-1	1	0	-1	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	0	0	-0.5	-0.5	0	0	0	0	0	0	0	0	0	0	0	0	0	0	1	0	-1	0	0
0	0	0	-1	0	1	0	0	0	0	1	0	0	0	0	-0.427	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
2	-1	-1	-1	0	0	1	0	0	0	0	0	0	0	0	0.209	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
0	0	0	0	0	0	0	0	0	0	0	-1	0	0	0	-0.096	-0.126	0	0	0	0	0	0	0	0	0	0	1	0	0	0	0	0	0
];

y = [50
7.065
0
12.61
0.235
-71
0
-53
3357
-8.04
-53.8
-5.6
2.825
-0.08
-52.52
0
-14
1433
-1370.8
22
-171
-50.6
-34.8
60.19
];

n = 6;
totalStructure=containers.Map('KeyType','double','ValueType','any');
R2Total = zeros(n,1);
SStot = sum((y).^2);
for i = 1:n
    sets = combnk(1:34,i);
    R2 = zeros(length(sets(:,1)),1);
    features = zeros(length(sets(:,1)),i);
    coeff = features;
    for j = 1:length(sets(:,1))
        I = sets(j,:);
        X = Aeq(:,I);
        beta = X\y;
        ypred = X*beta;
        SSres = sum((ypred-y).^2);
        R2temp = 1-SSres/SStot;
        R2(j) = 1- ((1-R2temp)*(length(y)-1)/(length(y)-i));
        %mdl = fitlm(X,y,'Intercept',false);
        %R2(j) = mdl.Rsquared.Adjusted;
        features(j,:) = I;
        coeff(j,:) = beta;
    end
    [M,I] = max(R2);
    R2Total(i) = M;
    totalStructure(i) = coeff(I,:);
    totalStructure(-i) = features(I,:);
end




